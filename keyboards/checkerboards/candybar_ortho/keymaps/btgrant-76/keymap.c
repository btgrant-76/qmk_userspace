/* Copyright 2021 Nathan Spears
 * Copyright 2024 Brian Grant <@btgrant-76>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include QMK_KEYBOARD_H
#include "btgrant-76.h"

#ifdef COMBO_ENABLE
#   include "combos.h"
#endif

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

[_BASE] = LAYOUT_btgrant_grid(
  //|--------------------------------------------------------------------------------------------------------------------------------------------------------|
      KC_PGUP,                             ___5BASE_1_L___,    KC_7,    KC_8,    KC_9, KC_PSLS,                             ___5BASE_1_R___, KC_LBRC, KC_RBRC,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      KC_PGDN,                             ___5BASE_2_L___,    KC_4,    KC_5,    KC_6, KC_PAST,                             ___5BASE_2_R___, KC_QUOT, KC_BSLS,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      KC_HOME,                             ___5BASE_3_L___,    KC_1,    KC_2,    KC_3, KC_PMNS,                             ___5BASE_3_R___, KC_MINS,  KC_EQL,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
       KC_END,    BACK,     FWD,        ___BASE_THUMB_L___,    KC_0, KC_PDOT, KC_PENT, KC_PPLS,      ___BASE_THUMB_R___, KC_LEFT, KC_DOWN,     KC_UP,KC_RIGHT
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
),
[_NUM] = LAYOUT_btgrant_grid(
  //|--------------------------------------------------------------------------------------------------------------------------------------------------------|
      _______,                              ___5NUM_1_L___, _______, _______, _______, _______,                              ___5NUM_1_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5NUM_2_L___, _______, _______, _______, _______,                              ___5NUM_2_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5NUM_3_L___, _______, _______, _______, _______,                              ___5NUM_3_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______, _______, _______,         ___NUM_THUMB_L___, _______, _______, _______, _______,         ___NUM_THUMB_R___, _______, _______, _______, _______
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
),
[_SYM] = LAYOUT_btgrant_grid(
  //|--------------------------------------------------------------------------------------------------------------------------------------------------------|
      _______,                              ___5SYM_1_L___, _______, _______, _______, _______,                              ___5SYM_1_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5SYM_2_L___, _______, _______, _______, _______,                              ___5SYM_2_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5SYM_3_L___, _______, _______, _______, _______,                              ___5SYM_3_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______, _______, _______,         ___SYM_THUMB_L___, _______, _______, _______, _______,         ___SYM_THUMB_R___, _______, _______, _______, _______
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
),
[_NAV] = LAYOUT_btgrant_grid(
  //|--------------------------------------------------------------------------------------------------------------------------------------------------------|
      _______,                              ___5NAV_1_L___, _______, _______, _______, _______,                              ___5NAV_1_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5NAV_2_L___, _______, _______, _______, _______,                              ___5NAV_2_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5NAV_3_L___, _______, _______, _______, _______,                              ___5NAV_3_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______, _______, _______,         ___NAV_THUMB_L___, _______, _______, _______, _______,         ___NAV_THUMB_R___, _______, _______, _______, _______
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
),
[_FUN] = LAYOUT_btgrant_grid(
  //|--------------------------------------------------------------------------------------------------------------------------------------------------------|
      _______,                              ___5FUN_1_L___, _______, _______, _______, _______,                              ___5FUN_1_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5FUN_2_L___, _______, _______, _______, _______,                              ___5FUN_2_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5FUN_3_L___, _______, _______, _______, _______,                              ___5FUN_3_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______, _______, _______,         ___FUN_THUMB_L___, _______, _______, _______, _______,         ___FUN_THUMB_R___, _______, _______, _______, _______
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
),
[_MSE] = LAYOUT_btgrant_grid(
  //|--------------------------------------------------------------------------------------------------------------------------------------------------------|
      _______,                              ___5MSE_1_L___, _______, _______, _______, _______,                              ___5MSE_1_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5MSE_2_L___, _______, _______, _______, _______,                              ___5MSE_2_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5MSE_3_L___, _______, _______, _______, _______,                              ___5MSE_3_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______, _______, _______,         ___MSE_THUMB_L___, _______, _______, _______, _______,         ___MSE_THUMB_R___, _______, _______, _______, _______
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
),
[_ADD] = LAYOUT_btgrant_grid(
  //|--------------------------------------------------------------------------------------------------------------------------------------------------------|
      _______,                              ___5ADD_1_L___, _______, _______, _______, _______,                              ___5ADD_1_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5ADD_2_L___, _______, _______, _______, _______,                              ___5ADD_2_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______,                              ___5ADD_3_L___, _______, _______, _______, _______,                              ___5ADD_3_R___, _______, _______,
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
      _______, _______, _______,         ___ADD_THUMB_L___, _______, _______, _______, _______,         ___ADD_THUMB_R___, _______, _______, _______, _______
  //|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
)
};

bool achordion_chord_keymap(uint16_t tap_hold_keycode,
                            keyrecord_t* tap_hold_record,
                            uint16_t other_keycode,
                            keyrecord_t* other_record) {
/*
    col, row
//|--------------------------------------------------------------------------------------------------------------------------------------------------------|
    0, 0     0, 1     1, 0     1, 1     2, 0   | 2, 1     3, 0     3, 1     4, 0     4, 1   | 5, 0     5, 1     6, 0     6, 1     7, 0     7, 1     8, 1
//|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
   [0, 2]   [0, 3]   [1, 2]   [1, 3]    2, 2   | 2, 3    [3, 2]   [3, 3]   [4, 2]   [4, 3]  | 5, 2     5, 3     6, 2     6, 3     7, 2     7, 3     8, 3
//|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
   [0, 4]    0, 5     1, 4     1, 5    [2, 4]  |[2, 5]    3, 4     3, 5     4, 4    [4, 5]  | 5, 4     5, 5     6, 4     6, 5     7, 4     7, 5     8, 5
//|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
    0, 6     0, 7    [1, 6]   [1, 7]   [2, 6]  |[2, 7]   [3, 6]   [3, 7]    4, 6     4, 7   | 5, 6     5, 7     6, 6     6, 7     7, 6     7, 7     8, 7
//|--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------|
*/
    if (tap_hold_record->event.key.row >= 6) {
        #ifdef CONSOLE_ENABLE
        print("triggered thumb cluster");
        #endif
        return true; // thumb clusters
    }

    switch (tap_hold_record->event.key.row) {
        case 2:
        case 3:
            switch (tap_hold_record->event.key.col) {
                case 0:
                case 1:
                    #ifdef CONSOLE_ENABLE
                    if (other_record->event.key.col >= 2) {
                        print("left HRM triggered");
                    } else {
                        print("left HRM not triggered");
                    }
                    #endif
                    return other_record->event.key.col >= 2;
                    break;
                case 3:
                case 4:
                    #ifdef CONSOLE_ENABLE
                    if (other_record->event.key.col <= 2) {
                        print("right HRM triggered");
                    } else {
                        print("right HRM not triggered");
                    }
                    #endif
                    return other_record->event.key.col <= 2;
                    break;
                default:
                    #ifdef CONSOLE_ENABLE
                    print("default:  HRM not triggered");
                    #endif
                    return false;
            }
        case 4:
            #ifdef CONSOLE_ENABLE
            if (other_record->event.key.col >= 2) {
                print("left Meh or Hyper triggered");
            } else {
                print("left Meh or Hyper not triggered");
            }
            #endif
            return other_record->event.key.col >= 2;
            break;
        case 5:
            #ifdef CONSOLE_ENABLE
            if (other_record->event.key.col <= 2) {
                print("right Meh or Hyper triggered");
            } else {
                print("right Meh or Hyper not triggered");
            }
            #endif
            return other_record->event.key.col <= 2;
            break;
        default:
            #ifdef CONSOLE_ENABLE
            print("default:  no hold triggered");
            #endif
            return false;
    }

    /*
    if (tap_hold_record->event.key.col < 2 && tap_hold_record->event.key.row <= 4) {
        #ifdef CONSOLE_ENABLE
        if (other_record->event.key.col >= 2) {
            print("left HRM or Hyper")
        }
        #endif
        return other_record->event.key.col >= 2;
    } else if (tap_hold_record->event.key.col > 2 && tap_hold_record->event.key.row <= 5) {
        #ifdef CONSOLE_ENABLE
        if (other_record->event.key.col <= 2) {
            print("right HRM or Hyper")
        }
        #endif
        return other_record->event.key.col <= 2;
    } else if (tap_hold_record->event.key.col == 2) {
        if (tap_hold_record->event.key.row == 4 && other_record->event.key.col >= 2) {
            #ifdef CONSOLE_ENABLE
            print("left Meh")
            #endif
            return true;
        } else if (tap_hold_record->event.key.row == 5 && other_record->event.key.col <= 2) {
            #ifdef CONSOLE_ENABLE
            print("right Meh")
            #endif
            return true;
        }
    }
    */
    return false;
};
